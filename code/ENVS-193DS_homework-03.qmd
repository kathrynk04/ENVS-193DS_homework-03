---
title: "ENVS-193DS_homework-03"
format: html
---

Github repo: https://github.com/kathrynk04/ENVS-193DS_homework-03.git

```{r message=FALSE}
library(tidyverse)
library(here)
library(flextable)
library(janitor)
library(readxl)
```

# Problem 1: Personal data

## a. Data summarizing

I could calculate the mean number of minutes I spent studying to compare average time spent studying between days that I consume caffeine before, during, or after studying because caffeine energizes me, so I think I spend more time studying on days that I consume caffeine before and during studying. On days that I don't drink caffeine or I drink caffeine after studying, I think I'm more likely to do more low-energy activities than studying because studying requires more concentration and effort.

## b. Visualization

```{r message=FALSE}
my_data <- read_csv(
  here("data", "my_data.csv")) |> 
  clean_names() |> 
  mutate(consumed_before_during_after_working = as_factor(consumed_before_during_after_working),
         consumed_before_during_after_working = fct_relevel(consumed_before_during_after_working,
                                    "None",
                                    "Before",
                                    "During",
                                    "After")) 

ggplot(data = my_data,
       aes(x = consumed_before_during_after_working,
           y = time_spent_working_min,
           color = consumed_before_during_after_working)) +
  labs(x = "Caffeine Consumption Time Relative to Studying",
       y = "Time Spent Studying (min)",
       title = "Time Spent Studying Across Caffeine Consumption Time Relative to Studying") +
  geom_jitter(width = 0.1,
              height = 0,
              shape = 21,
              alpha = 0.6) +
  stat_summary(geom = "point",
               fun = mean,
               size = 4) +
  scale_color_manual(values = c("None" = "red",
                                "Before" = "orange",
                                "During" = "green",
                                "After" = "blue")) +
  theme(legend.position = "none")


```

## c. Caption

Figure 1: Time spent studying in minutes across caffeine consumption time relative to studying. Points are colored according to whether caffeine was consumed before studying, during studying, after studying, or not at all.

## d. Table presentation

```{r message = FALSE}
ft <- my_data |> 
  select(consumed_before_during_after_working, time_spent_working_min) |> 
  group_by(consumed_before_during_after_working) |> 
  summarize(mean_time_spent_studying = mean(time_spent_working_min, na.rm = FALSE)) 

ft$mean_time_spent_studying <- round(ft$mean_time_spent_studying, 1)

flextable(ft) |> 
  set_header_labels(ft,
                    consumed_before_during_after_working = "Caffeine Consumption Time Relative to Studying",
                    mean_time_spent_studying = "Average Time Spent Studying (min)") |> 
  set_table_properties(layout = "autofit")
```

